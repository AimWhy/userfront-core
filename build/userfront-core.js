function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=e(require("axios")),n=e(require("js-cookie"));function o(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}const{apiUrl:r,privateIPRegex:s}={apiUrl:"https://api.userfront.com/v0/",privateIPRegex:/((^127\.)|(^10\.)|(^172\.1[6-9]\.)|(^172\.2[0-9]\.)|(^172\.3[0-1]\.)|(^192\.168\.))\d{1,3}\.\d{1,3}/g},i=e=>{try{const t=e||window.location.hostname;return!(!t.match(/localhost/g)&&!t.match(s))}catch(e){return!0}},a={mode:i()?"test":"live"};function c(e,t,o){const r=`${o}.${a.tenantId}`;t=t||{secure:"live"===a.mode,sameSite:"Lax"},"refresh"===o&&(t.sameSite="Strict"),n.set(r,e,t)}function u(e){n.remove(e),n.remove(e,{secure:!0,sameSite:"Lax"}),n.remove(e,{secure:!0,sameSite:"None"}),n.remove(e,{secure:!1,sameSite:"Lax"}),n.remove(e,{secure:!1,sameSite:"None"})}module.exports={setMode:function(){try{const e=o(function(){return Promise.resolve(t.get(`${r}tenants/${a.tenantId}/mode`)).then(function({data:e}){a.mode=e.mode||"test"})},function(){a.mode="test"});return Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},init:function(e,t={}){if(!e)return console.warn("Userfront initialized without tenant ID");a.tenantId=e,a.accessTokenName="access."+e,a.idTokenName="id."+e,a.refreshTokenName="refresh."+e},isTestHostname:i,logout:function(){try{const e=n.get(a.accessTokenName);if(!e)return Promise.resolve();const s=o(function(){return Promise.resolve(t.get(r+"auth/logout",{headers:{authorization:"Bearer "+e}})).then(function({data:e}){u(a.accessTokenName),u(a.idTokenName),u(a.refreshTokenName),window.location.href=e.redirectTo})},function(){});return Promise.resolve(s&&s.then?s.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},setCookie:c,signup:function({username:e,name:n,email:o,password:s}){try{return Promise.resolve(t.post(r+"auth/create",{tenantId:a.tenantId,username:e,name:n,email:o,password:s})).then(function({data:e}){if(!e.tokens)throw new Error("Please try again.");c(e.tokens.access.value,e.tokens.access.cookieOptions,"access"),c(e.tokens.id.value,e.tokens.id.cookieOptions,"id"),c(e.tokens.refresh.value,e.tokens.refresh.cookieOptions,"refresh"),window.location.href=e.redirectTo})}catch(e){return Promise.reject(e)}},store:a};
//# sourceMappingURL=userfront-core.js.map
