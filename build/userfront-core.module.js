import e from"axios";import t from"js-cookie";function o(e,t){try{var o=e()}catch(e){return t(e)}return o&&o.then?o.then(void 0,t):o}var r="https://api.userfront.com/v0/",n=/((^127\.)|(^10\.)|(^172\.1[6-9]\.)|(^172\.2[0-9]\.)|(^172\.3[0-1]\.)|(^192\.168\.))\d{1,3}\.\d{1,3}/g,s=function(e){try{var t=e||window.location.hostname;return!(!t.match(/localhost/g)&&!t.match(n))}catch(e){return!0}},a={mode:s()?"test":"live"};function i(e,o,r){var n=r+"."+a.tenantId;o=o||{secure:"live"===a.mode,sameSite:"Lax"},"refresh"===r&&(o.sameSite="Strict"),t.set(n,e,o)}function c(e){t.remove(e),t.remove(e,{secure:!0,sameSite:"Lax"}),t.remove(e,{secure:!0,sameSite:"None"}),t.remove(e,{secure:!1,sameSite:"Lax"}),t.remove(e,{secure:!1,sameSite:"None"})}var u={getMode:function(){try{var t=o(function(){return Promise.resolve(e.get(r+"tenants/"+a.tenantId+"/mode")).then(function(e){a.mode=e.data.mode||"test"})},function(){a.mode="test"});return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},init:function(e,t){if(void 0===t&&(t={}),!e)return console.warn("Userfront initialized without tenant ID");a.tenantId=e,a.signupModId=t.signup,a.loginModId=t.login,a.logoutModId=t.logout,a.resetModId=t.reset,a.accessTokenName="access."+e,a.idTokenName="id."+e,a.refreshTokenName="refresh."+e},isTestHostname:s,logout:function(){try{var n=t.get(a.accessTokenName);if(!n)return Promise.resolve();var s=o(function(){return Promise.resolve(e.get(r+"/auth/logout",{headers:{authorization:"Bearer "+n}})).then(function(e){var t=e.data;c(a.accessTokenName),c(a.idTokenName),c(a.refreshTokenName),window.location.href=t.redirectTo})},function(){});return Promise.resolve(s&&s.then?s.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},scope:a,setCookie:i,signup:function(t){var o=t.username,n=t.name,s=t.email,c=t.password;try{return Promise.resolve(e.post(r+"auth/create",{tenantId:a.tenantId,username:o,name:n,email:s,password:c})).then(function(e){var t=e.data;if(!t.tokens)throw new Error("Please try again.");i(t.tokens.access.value,t.tokens.access.cookieOptions,"access"),i(t.tokens.id.value,t.tokens.id.cookieOptions,"id"),i(t.tokens.refresh.value,t.tokens.refresh.cookieOptions,"refresh"),window.location.href=t.redirectTo})}catch(e){return Promise.reject(e)}}};export default u;
//# sourceMappingURL=userfront-core.module.js.map
